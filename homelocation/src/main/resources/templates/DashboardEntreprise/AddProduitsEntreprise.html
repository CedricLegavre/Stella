<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz.thymeleaf/layout"
	layout:decorator="TemplateDashboardEnterprise"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<script>
function updateSize() {
  var nBytes = 0,
      oFiles = document.getElementById("uploadInput").files,
      nFiles = oFiles.length;
  for (var nFileId = 0; nFileId < nFiles; nFileId++) {
    nBytes += oFiles[nFileId].size;
  }
  var sOutput = nBytes + " bytes";
  // partie de code facultative pour l'approximation des multiples
  for (var aMultiples = ["KiB", "MiB", "GiB", "TiB", "PiB", "EiB", "ZiB", "YiB"], nMultiple = 0, nApprox = nBytes / 1024; nApprox > 1; nApprox /= 1024, nMultiple++) {
    sOutput = nApprox.toFixed(3) + " " + aMultiples[nMultiple] + " (" + nBytes + " bytes)";
  }
  // fin de la partie de code facultative
  document.getElementById("fileNum").innerHTML = nFiles;
  document.getElementById("fileSize").innerHTML = sOutput;
}
</script>

<title>Dashboard - Produits</title>
</head>
<body>

	<div layout:fragment="content">
		<div class="col-xl-10">
			<h2 class="h2">Ajout d'un Produit</h2>
		</div>

		<!-- ======= Hero Section ======= -->
		<form class="needs-validation" novalidate
			th:action="@{AddProduitEntreprise}" enctype="multipart/form-data"
			method="post">
			<section id=incription class="d-flex align-items-center">
				<div class="container center ">
					<div class="row">
						<div class="col-lg-6">

							<div class="form-group">
								<label>Nom Produit</label> <input type="text"
									class="form-control" name="nom" id="nom" required
									th:value="${produit.nom}">
								<div class="invalid-feedback">Valeur incorrecte ou non
									saisie</div>
							</div>

							<div class="form-group">
								<label>Description</label> <input type="text" name="description"
									class="form-control" id="description" required
									th:value="${produit.description}"></input>
								<div class="invalid-feedback">Valeur incorrecte ou non
									saisie</div>
							</div>

							<div class="form-group">
								<label>pays_origine</label> <input type="text"
									name="pays_origine" class="form-control" id="pays_origine"
									required th:value="${produit.pays_origine}">
								<div class="invalid-feedback">Valeur incorrecte ou non
									saisie</div>
							</div>

						</div>
						<div class="col-lg-6 ">
							<div class="form-group">
								<label>prixPoids</label> <input type="text" class="form-control"
									id="prixPoids" required name="prixPoids"
									th:value="${produit.prixPoids}">
								<div class="invalid-feedback">Valeur incorrecte ou non
									saisie</div>
							</div>
							<div class="form-group">
								<label>prixUnitaire</label> <input type="text"
									name="prixUnitaire" class="form-control" id="prixUnitaire"
									required th:value="${produit.prixUnitaire}">
								<div class="invalid-feedback">Valeur incorrecte ou non
									saisie</div>
							</div>
							<div class="form-group">
								<label>Image Produit</label> <input type="file" id="uploadInput"
									th:values="${produit.image}" class="form-control-file"
									name="file">
							</div>
						</div>
						<div class="col-lg-12 text-center">
							<a href="/ProduitsEntreprise" class="btn btn-primary">Retour</a>
							<button type="submit" class="btn btn-primary">Valider</button>
						</div>
					</div>
				</div>
		</form>

		<!-- Vendor JS Files -->
		<script src="assets/vendor/jquery/jquery.min.js"></script>
		<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
		<script src="assets/vendor/php-email-form/validate.js"></script>
		<script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
		<script src="assets/vendor/counterup/counterup.min.js"></script>
		<script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
		<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
		<script src="assets/vendor/venobox/venobox.min.js"></script>
		<script src="assets/vendor/aos/aos.js"></script>
		<!-- Template Main JS File -->
		<script src="assets/js/main.js"></script>
		<script>
			(function() {
				'use strict';
				window
						.addEventListener(
								'load',
								function() {
									let forms = document
											.getElementsByClassName('needs-validation');
									let validation = Array.prototype.filter
											.call(
													forms,
													function(form) {
														form
																.addEventListener(
																		'submit',
																		function(
																				event) {
																			if (form
																					.checkValidity() === false) {
																				event
																						.preventDefault();
																				event
																						.stopPropagation();
																			}
																			form.classList
																					.add('was-validated');
																		},
																		false);
													});
								}, false);
			})();
		</script>

		<script>
			var current_file = = document.getElementById('file').files[0];
			var numFiles = files.length;
			alert(numFiles);
			
			var reader = new FileReader();
			if (current_file.type.indexOf('image') == 0) {
				reader.onload = function(event) {
					var image = new Image();
					image.src = event.target.result;

					image.onload = function() {
						var maxWidth = 1024, maxHeight = 1024, imageWidth = image.width, imageHeight = image.height;

						if (imageWidth > imageHeight) {
							if (imageWidth > maxWidth) {
								imageHeight *= maxWidth / imageWidth;
								imageWidth = maxWidth;
							}
						} else {
							if (imageHeight > maxHeight) {
								imageWidth *= maxHeight / imageHeight;
								imageHeight = maxHeight;
							}
						}

						var canvas = document.createElement('canvas');
						canvas.width = imageWidth;
						canvas.height = imageHeight;
						image.width = imageWidth;
						image.height = imageHeight;
						var ctx = canvas.getContext("2d");
						ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

						$('img#apercu').src = canvas
								.toDataURL(current_file.type);
					}
				}
				reader.readAsDataURL(current_file);
			}
		</script>


	</div>

</body>
</html>